<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE ELITE TRADER</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Box Icons -->
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <style>

.main {
            visibility: hidden;
        }
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #009E60		;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid #FFF;
            border-bottom-color: #454B1B	;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

      body {
        background-image: url("https://unsplash.com/photos/red-and-blue-light-streaks-fiXLQXAhCfk");
        background-size: cover;
        background-position: center;
      }


        .iframe-container {
            position: relative;
            width: 60%;
            height: 800px;
            resize: both;
            overflow: auto;
            transition: height 3s ease-in-out; /* Add transition for smooth animation */
        }

        .iframe-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        

        .iframe-container.active {
            height: 100%; /* Set the height to 0 when the container is not active */
        }

        .iframe-container.active iframe {
            display: none; /* Hide the iframe when the container is not active */
        }

        .iframe-container.active + button {
            display: none; /* Hide the button when the container is active */
        }





      
    .tab-container {
      display: flex;
      flex-direction: column;
      height: 80vh;
    }

    .tab-bar {

      display: flex;
      align-items: center;
      
      
    }


    

    




    

.container {
  text-align: center;
}

h1 {
  color: #ffffff;
  text-align: center;
  margin-top: 30px;
  
}

h2 {
  color: #ffffff;
  text-align: center;
  font-size: large;
}

button {
  display: block;
  margin: 30px auto;
  padding: 10px 20px;
  font-size: 12px;
  color: #fff;
  background-color: #009E60;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}




/*BUTTON*/
button {
  --border: 5px;    /* the border width */
  --slant: 0.7em;   /* control the slanted corners */
  --color: #ffffff; /* the color */
  
  font-size: 29px;
  padding: 0.4em 1.2em;
  border: none; 
  cursor: pointer;
  font-weight: bold;
  color: var(--color);
  background: 
     linear-gradient(to bottom left,var(--color)  50%,#0000 50.1%) top right,
     linear-gradient(to top   right,var(--color)  50%,#0000 50.1%) bottom left;
  background-size: calc(var(--slant) + 1.3*var(--border)) calc(var(--slant) + 1.3*var(--border));
  background-repeat: no-repeat;
  box-shadow:
    0 0 0 200px inset var(--s,#0000),
    0 0 0 var(--border) inset var(--color);
  clip-path: 
      polygon(0 0, calc(100% - var(--slant)) 0, 100% var(--slant),
              100% 100%, var(--slant) 100%,0 calc(100% - var(--slant))
             );
  transition: color var(--t,0.3s), background-size 0.3s;
}
button:focus-visible {
  outline-offset: calc(-1*var(--border));
  outline: var(--border) solid #000c;
  clip-path: none;
  background-size: 0 0;
}
button:hover,
button:active{
  background-size: 100% 100%;
  color: #009E60;
  --t: 0.2s 0.1s;
}
button:active {
  --s: #0005;
  transition: none;
}



/*STATUS COLOR*/
.status-indicator {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 5px;
    background-color: red; /* Set the default color to red */
  }

  .status-indicator.success {
    background-color: green;
  }

  .status-indicator.error {
    background-color: red;
  }



  /* Media Query for Small Screens (Phones) */
@media only screen and (max-width: 768px) {
  button{
    font-size: 24px;

  }
}

.inner-nav .balance,
.inner-nav #accountSelect,
.inner-nav #status {
  margin-right: 20px;
  font-size: 12.5px;

}

.profile-section {
            display: flex;
            align-items: center;
            gap: 15px;
            padding-right: 10px;
            height: 70px;
        }

        .profile {
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(15, 8, 122, 0.253);
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            overflow: hidden; /* This ensures the image stays within the bounds */
        }

        .profile img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* This ensures the image covers the area nicely */
            border-radius: 10px;
        }

        .logout-btn {
            background: #009E60;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .logout-btn:hover {
            background: #009E60            ;
            color: white;
            transform: translateY(-2px);
        }

        .logout-btn i {
            font-size: 16px;
        }

        /* For mobile responsiveness */
        @media (max-width: 768px) {
            .profile {
                width: 25px;
                height: 25px;
            }

            .logout-btn {
                padding: 6px 12px;
                font-size: 12px;
            }

            .logout-btn span {
                display: none; /* Hide text on mobile, show only icon */
            }
        }

  </style>
        
    </style>
</head>
<body>
  <div class="loading-screen">
    <span class="loader"></span>
</div>
    <div class="main">
      <div class="side-navbar">
        <ul>
        <!--sidenav icon for x-->
        <li><a>
          <span class="icon" id="close-icon"><i class='bx bx-x'></i></span>           
        </a></li>
        <!--sidenav icon for x-->
        <li>
          <span class="icon"><i class='bx bxs-home-circle' onclick="navigateTo('index.html')"></i></span>
          <span class="text"></span>
        </li>
                      
        <!--
        <li>
          <span class="icon"><i class='bx bxs-home-circle' onclick="navigateTo('1top10.html')"></i></span>
          <span class="text"></span>
        </li>
        <li>
          <span class="icon"><i class='bx bxs-home-circle' onclick="navigateTo('2chart.html')"></i></span>
          <span class="text"></span>
        </li>
        -->
        <li>
          <span class="icon"><img src="images/3-removebg-preview.png" alt="Icon Image" class="icon-image" onclick="navigateTo('3evenoddtrader.html')"></i></span>
          <span class="text"></span>
        </li>
        <li>
          <span class="icon"><img src="images/4-removebg-preview.png" alt="Icon Image" class="icon-image" onclick="navigateTo('4overundertrader.html')"></i></span>
          <span class="text"></span>
        </li>
        <li>
          <span class="icon"><img src="images/5-removebg-preview.png" alt="Icon Image" class="icon-image" onclick="navigateTo('5matchdiffertrader.html')"></i></span>
          <span class="text"></span>
        </li>
        <li>
          <span class="icon"><img src="images/6-removebg-preview.png" alt="Icon Image" class="icon-image" onclick="navigateTo('6risefalltrader.html')"></i></span>
          <span class="text"></span>
        </li>
        <li>
          <span class="icon"><img src="images/calculator (2).png" alt="Icon Image" class="icon-image" style="width: 26px; height: 26px;" onclick="navigateTo('tools.html')"></i></span>
          <span class="text"></span>
        </li>
        <li>
          <span class="icon"><img src="images/cfd.png" alt="Icon Image" class="icon-image"  onclick="navigateTo('9newtraderprice.html')"></i></span>
          <span class="text"></span>
        </li>
        <li>
          
          <span class="text"></span>
        </li>
        <!--
        -->
        </ul>
      </div>
        <div class="content">
            <div class="top-navbar">
                <img class="bx bx-menu" id="menu-icon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAUpJREFUSEuNVtsWgzAIA///m9cde5FEgu0etlqBYBPi3LYfN7dmbRunA9zNZvKmUASKSpjLgffV/MygeR/DPms/2WYNc2ENEPE0a2VWlc+dEgAAPzVS131DAIin7PVSqBtwULFYAdTAAXYf+4M8OPi11gVzfy2CcB1tzN3+ExHuvWc6dmq9JQCGara60rBbgIF2IiWW9RddrKIqEuV4MnSzTkkyDmBnJAHXMqXZemthcdCDBNOxxRysq4eDPGhjZwCIZBRNOqLbqwb57pd37yKAT0mf6T2OkUVKmj3hDudGc8MDPUhejIMtnxjcSUPfk6xnadatBw0VmI4oq6hCCWLp1P3ycOKwG22GcxffaDgOaY3xWUXihYNE6GrydUFpqUayBPSljWQF68ABG1wqdVJbJIFM0W6EUxbd5X8bL4/Seq+mgJ8yKUPc/gPLFL8gjI6pZAAAAABJRU5ErkJggg=="/>
                <div class="inner-nav">
                  <div class="row">
                    <div class="col-md-12 text-center">
                      <h1 class="animate-charcter"> THE Hifex TRADER</h1>
                    </div>
                  </div>
                  <div class="balance">
                    <p id="acctValue"></p>
                    <p id="balance"></p>
                  </div>
                
                  <select id="accountSelect" class="custom-select" onchange="handleAccountSelection(acct1, acct2, token1, token2)">
                    <option value="acct1" selected>Real Account</span></option>
                    <option value="acct2">Demo Account</span></option>
                  </select>                  
                   
                  <div class="status">
                    <div class="status-item">
                      <h>Linked:</h>
                      <div id="auth-status-indicator" class="status-indicator"></div>
                    </div>
                    <div class="status-item">
                      <h>Connected:</h>
                      <div id="websocket-status-indicator" class="status-indicator"></div>
                    </div>
                  </div>
                  
                </div>
                <div class="profile-section">
                  <div class="profile">
                      <!-- Default profile image as fallback -->
                      <img src="img/logo.png" alt="Profile" id="userProfileImg">
                  </div>
                  <button class="logout-btn" onclick="handleLogout()">
                      <i class='bx bx-log-out'></i>
                      <span>Logout</span>
                  </button>
              </div>
            </div>

            <div class="tab-container">
                
                <div class="tab-content">
                  <div class="tab-bar">
                    <!-- TradingView Widget BEGIN -->
                    <div class="tradingview-widget-container">
                      <div class="tradingview-widget-container__widget"></div>
                      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
                      </script>
                    </div>
                    <!-- TradingView Widget END -->
                  </div>
                  <div id="tab1" class="tab-pane active">
                                   
                    <h1>WELCOME TO THE Hifex TRADER</h1>
                    <div class="glass-container" style="display: none;" >
                      <!-- Content of the container goes here -->
                      <div class="logo"><img src="img/profile.png"></div>
                      <div class="chip"><img src="https://raw.githubusercontent.com/dasShounak/freeUseImages/main/chip.png" alt="chip"></div>
                      <div id="balanceSection">
                        <div class="number" id="cardNumber">CR********</div>
                        <div class="name" id="cardbalance">BALANCE: </div>
                        <div class="from" id="time">TIME: 4:47 PM</div>
                        <div class="to" id="date">7/28/24</div>
                      </div>
                      
                      
                      <div class="ring"></div>
                    </div>                    
                    <button onclick="window.location.href = 'linkoptions.html'">Link account</button>
                    <button onclick="window.location.href = 'https://deriv.com/?t=bymfukeAyyzBduMX0ohjZ2Nd7ZgqdRLk&utm_source=affiliate_208361&utm_medium=affiliate&utm_campaign=MyAffiliates&utm_content=&referrer=www.tiktok.com'">Create account</button>
                    <button onclick="sidnavtoggle()">Start trading</button>
                  </div>
                  <div class="tab-bar">
                    <!-- TradingView Widget BEGIN -->
                    <div class="tradingview-widget-container">
                      <div class="tradingview-widget-container__widget"></div>
                      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
                      </script>
                    </div>
                    <!-- TradingView Widget END -->
                  </div>
                  
              
                </div>
              </div>

        </div>
    </div>

       <!-- Add Firebase SDK before your other scripts -->
       <!-- Add Firebase before your other scripts -->
       <script type="module">
        // Import the functions you need from the SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyDrkPtwdvEk0u4poyZDq1tgtCuxyfP7zgM",
          authDomain: "hifextrader.firebaseapp.com",
          projectId: "hifextrader",
          storageBucket: "hifextrader.firebasestorage.app",
          messagingSenderId: "239115219191",
          appId: "1:239115219191:web:04c8407c8c80a0a20b23f2"
        };
    
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
    
        // Function to create/update user record
        async function updateUserRecord(user) {
            try {
                const userRef = doc(db, "users", user.uid);
                const userDoc = await getDoc(userRef);
                
                if (!userDoc.exists()) {
                    // New user - create record with pending status
                    await setDoc(userRef, {
                        email: user.email,
                        displayName: user.displayName,
                        photoURL: user.photoURL,
                        status: "pending",
                        joinDate: serverTimestamp(),
                        lastLogin: serverTimestamp()
                    });
                } else {
                    // Existing user - update last login
                    await setDoc(userRef, {
                        lastLogin: serverTimestamp(),
                        email: user.email,
                        displayName: user.displayName,
                        photoURL: user.photoURL
                    }, { merge: true });
                }
            } catch (error) {
                console.error("Error updating user record:", error);
            }
        }
    
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            const mainContent = document.querySelector('.main');
            const loadingScreen = document.querySelector('.loading-screen');
            const userProfileImg = document.getElementById('userProfileImg');
    
            // Check authentication state
            onAuthStateChanged(auth, async (user) => {
                if (!user) {
                    window.location.href = 'login.html';
                    return;
                }
    
                try {
                    // Check user permissions
                    const userRef = doc(db, "users", user.uid);
                    const userDoc = await getDoc(userRef);
                    const userData = userDoc.data();
    
                    // Update user record
                    await updateUserRecord(user);
    
                    if (!userData || userData.status === 'pending') {
                        alert("Your account is pending approval. Please contact admin.");
                        await signOut(auth);
                        window.location.href = 'login.html';
                        return;
                    }
    
                    if (userData.status === 'blocked') {
                        alert("Your account has been blocked. Please contact admin.");
                        await signOut(auth);
                        window.location.href = 'login.html';
                        return;
                    }
    
                    // User is approved - proceed with normal login
                    console.log("Logged in as:", user.email);
                    
                    // Show main content and hide loading screen
                    if (mainContent && loadingScreen) {
                        mainContent.style.visibility = 'visible';
                        loadingScreen.style.display = 'none';
                    }
    
                    // Update profile image
                    if (userProfileImg) {
                        if (user.photoURL) {
                            userProfileImg.src = user.photoURL;
                        } else if (user.email) {
                            // If no profile photo, generate initials avatar
                            const initials = user.email.charAt(0).toUpperCase();
                            const canvas = document.createElement('canvas');
                            const context = canvas.getContext('2d');
                            canvas.width = 200;
                            canvas.height = 200;
    
                            // Draw background
                            context.fillStyle = '#3563f0';
                            context.fillRect(0, 0, canvas.width, canvas.height);
    
                            // Draw text
                            context.fillStyle = 'white';
                            context.font = 'bold 100px Arial';
                            context.textAlign = 'center';
                            context.textBaseline = 'middle';
                            context.fillText(initials, canvas.width/2, canvas.height/2);
    
                            userProfileImg.src = canvas.toDataURL();
                        }
                    }
    
                    // Update UI with user info if needed
                    const titleElement = document.querySelector('.animate-charcter');
                    if (titleElement && user.displayName) {
                        titleElement.textContent = `Welcome, ${user.displayName}`;
                    }
    
                } catch (error) {
                    console.error("Error checking user permissions:", error);
                    alert("Error checking permissions. Please try again.");
                    window.location.href = 'login.html';
                }
            });
        });
    
        // Make logout function globally available
        window.handleLogout = async function() {
            const loadingScreen = document.querySelector('.loading-screen');
            if (loadingScreen) {
                loadingScreen.style.display = 'flex';
            }
            
            try {
                await signOut(auth);
                window.location.href = 'login.html';
            } catch (error) {
                console.error("Error signing out:", error);
                alert("Error signing out. Please try again.");
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
            }
        };
    </script>

    <script>

function navigateTo(url) {
    window.location.href = url;
  }

    /1///////////////////////////////////////////////////////
    //////////////////////////TEMPLATE CODE/////////////////
    ////////////////////////////////////////////////////////

    const urlParams = new URLSearchParams(window.location.search);
    const token1 = sessionStorage.getItem("token1");
    const token2 = sessionStorage.getItem("token2");
    const acct1 = sessionStorage.getItem("acct1");
    const acct2 = sessionStorage.getItem("acct2");
    const cur1 = sessionStorage.getItem("cur1");
    const cur2 = sessionStorage.getItem("cur2");


    ////STATUS INICATORS
    // Update the authentication status indicator
    // Update the authentication status indicator
    function updateAuthStatusIndicator(isAuthenticated) {
      const authStatusIndicator = document.getElementById('auth-status-indicator');
      authStatusIndicator.classList.remove('success', 'error');
      authStatusIndicator.classList.add(isAuthenticated ? 'success' : 'error');
    }

    // Update the WebSocket status indicator
    function updateWebSocketStatusIndicator(isOpen) {
      const websocketStatusIndicator = document.getElementById('websocket-status-indicator');
      websocketStatusIndicator.classList.remove('success', 'error');
      websocketStatusIndicator.classList.add(isOpen ? 'success' : 'error');
    }
    
    ////CONNECTION AND GET BALANCE////THERE ARE CHANGES IN CLOSE AND OPEN EVENT
        const app_id = sessionStorage.getItem("app_id_session");
 // Your app_id
    let websocket = null; // Declare the websocket variable globally
    let isConnectionClosed = false;
    let auth_token = '';

    // Check if selectedAccount is stored in session storage
    const storedAccount = sessionStorage.getItem("selectedAccount");

    // If storedAccount exists, set selectedAccount to its value
    const selectedAccount = storedAccount ? storedAccount : "acct1";

    // Update the account selection dropdown with the stored value
    const accountSelect = document.getElementById("accountSelect");
    accountSelect.value = selectedAccount;

    // Save selectedAccount to session storage whenever it changes
    accountSelect.addEventListener("change", function() {
        const selectedAccount = accountSelect.value;
        sessionStorage.setItem("selectedAccount", selectedAccount);
    });

    handleAccountSelection(acct1,acct2,token1,token2);////////DO NOT REMOVE THIS SEMI COLON IT WILL MESS THE WHOLE CODE!!!!!!!!!!!!


    function handleAccountSelection(acct1,acct2,token1,token2) {
      
      const accountSelect = document.getElementById('accountSelect');
      const selectedAccount = accountSelect.value;

      if (websocket) {
        isConnectionClosed = true; // Set the flag to true to indicate intentional closure
        websocket.close();
      }

      // Open a new websocket connection with the respective auth token
      let auth_token = '';
      if (selectedAccount === 'acct1') {
        auth_token = token1;
      } else if (selectedAccount === 'acct2') {
        auth_token = token2;
      }

 // Replace with your actual app ID
      websocket = new WebSocket(`wss://ws.derivws.com/websockets/v3?app_id=${app_id}`);
      websocket.addEventListener('open', (event) => {
        console.log('Websocket connection established:', event);
        console.log('first token: ',auth_token);

        const authPayload = JSON.stringify({
          authorize: auth_token,
        });

        websocket.send(authPayload);
        console.log('third token: ',auth_token);
      });

      // Function to update the current time and date
function updateTimeAndDate() {
  const currentDateTime = new Date();
  const currentHours = currentDateTime.getHours();
  const currentMinutes = currentDateTime.getMinutes();
  const formattedTime = `${currentHours % 12 || 12}:${currentMinutes < 10 ? '0' + currentMinutes : currentMinutes} ${currentHours >= 12 ? 'PM' : 'AM'}`;
  const formattedDate = `${currentDateTime.getMonth() + 1}/${currentDateTime.getDate()}/${currentDateTime.getFullYear()}`;

  document.getElementById("time").innerText = "TIME: " + formattedTime;
  document.getElementById("date").innerText = formattedDate;
}

// Update time and date every minute
setInterval(updateTimeAndDate, 60000);
updateTimeAndDate();






      ////////////////////////////////////////////////////////
    //////////////////////////TEMPLATE CODE/////////////////
    ////////////////////////////////////////////////////////




    
      ///////////////////////////////////////////////////////////
      //////HERE IS WHERE MOST OF THE SCRIPT ALGO  WILL GO///////
      ///////////////////////////////////////////////////////////

      
      websocket.addEventListener('message', (event) => {
      const receivedMessage = JSON.parse(event.data);
      if (receivedMessage.msg_type === 'authorize') {
          console.log('Authorization successful:', receivedMessage);
          // Subscribe to stream for open contracts
          const balanceRequest = JSON.stringify({
                      balance: 1,
                      account: 'current',
                      subscribe: 1,
                      passthrough: {},
                      req_id: 1
                  });
          websocket.send(balanceRequest);
          if (selectedAccount === 'acct1') {
            document.getElementById("acctValue").innerText = acct1 ? acct1 : "Not Linked";
          } else if (selectedAccount === 'acct2') {
            document.getElementById("acctValue").innerText = acct2 ?  + acct2 : "Not Linked";
          }
          
      }


else if (receivedMessage.msg_type === 'balance') {
  if (receivedMessage.error) {
    console.error('Balance request error:', receivedMessage.error);
    document.getElementById("balance").innerText = "Balance: ";
    document.getElementById("cardbalance").innerText = "BALANCE: ";
    if (selectedAccount === 'acct1') {
      if (acct1) {
        document.getElementById("acctValue").innerText = acct1 + cur1;
        document.getElementById("cardNumber").innerText = acct1 + cur1;
      } else if (acct2) {
        document.getElementById("acctValue").innerText = "create or/switch to demo";
        document.getElementById("cardNumber").innerText = "create or/switch to demo";
      }
    } else if (selectedAccount === 'acct2') {
      if (acct2) {
        document.getElementById("acctValue").innerText = acct2 + cur2;
        document.getElementById("cardNumber").innerText = acct2 + cur2;
      } else if (acct1) {
        document.getElementById("acctValue").innerText = "Demo Acct - No Account";
        document.getElementById("cardNumber").innerText = "Demo Acct - No Account";
      }
    }
  } else {
    // Handle balance response here
    if (selectedAccount === 'acct1') {
      document.getElementById("acctValue").innerText = acct1;
      document.getElementById("balance").innerText = "Balance: " + receivedMessage.balance.balance + " " + cur1;
      document.getElementById("cardNumber").innerText = acct1 + cur1;
      document.getElementById("cardbalance").innerText = "BALANCE: " + receivedMessage.balance.balance + " " + cur1;
    } else if (selectedAccount === 'acct2') {
      document.getElementById("acctValue").innerText = acct2;
      document.getElementById("balance").innerText = "Balance: " + receivedMessage.balance.balance + " " + cur2;
      document.getElementById("cardNumber").innerText = acct2 + cur2;
      document.getElementById("cardbalance").innerText = "BALANCE: " + receivedMessage.balance.balance + " " + cur2;
    }

    // Update time and date
    updateTimeAndDate();

    // When WebSocket connection is open
    updateWebSocketStatusIndicator(true);
    // When authentication is successful
    updateAuthStatusIndicator(true);
  }
}




      
      else {
          console.log('received message: ', receivedMessage);
      } });

      websocket.addEventListener('close', (event) => {
      console.log('websocket connection closed: ', event);
      // When authentication fails
      updateAuthStatusIndicator(false);
      // When WebSocket connection is closed
      updateWebSocketStatusIndicator(false);
      if (!isConnectionClosed) {
          // Re-run the script with the new selected auth_token only if the closure was unexpected
          handleAccountSelection(acct1, acct2, token1, token2);
        } else {
          isConnectionClosed = false; // Reset the flag for the next connection
        }

      });

      websocket.addEventListener('error', (event) => {
      console.log('an error happened in our websocket connection', event);
      });


      ///////////////////////////////////////////////////////////
      //////HERE IS WHERE MOST OF THE SCRIPT ALGO  WILL GO///////
      ///////////////////////////////////////////////////////////

    }
    //////REMEMBER TO CLOSE HERE SINCE IT IS IN "handleAccountSelection(acct1,acct2,token1,token2)"" FUNCTION
    

    






    ///////MENU////////////////
    let menu = document.querySelector('#menu-icon');
    let sidenavbar = document.querySelector('.side-navbar');
    let content = document.querySelector('.content');
    let iframeContainer = document.querySelector('.iframe-container');
    let toggleButton = document.querySelector('#toggle-button');

    

    const closeIcon = document.getElementById('close-icon');
    closeIcon.addEventListener('click', () => {
      sidenavbar.classList.remove('active');
      content.classList.remove('active');
    });

    menu.onclick = () => {
        sidenavbar.classList.toggle('active');
        content.classList.toggle('active');
    }

    toggleButton.onclick = () => {
        iframeContainer.classList.toggle('active');
    }

    //BUTTON
    function redirectToOAuth() {
        var appId = "68610"; // Replace with your actual app ID
        var redirectUrl = encodeURIComponent("https://[https://newversionelitetrader.web.app]/extract_token.html");
        var oauthUrl = "https://oauth.deriv.com/oauth2/authorize?app_id=" + appId + "&redirect_uri=" + redirectUrl;
        window.location.href = oauthUrl;
    }


    //SIDENAV
    function sidnavtoggle(){
      sidenavbar.classList.toggle('active');
      content.classList.toggle('active');
    }
    </script>
</body>
</html>
