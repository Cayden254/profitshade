<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ProfitShade FX - Trade Smart, Profit Sharp üî•</title>
  <link rel="icon" href="/logo.png" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    body {
      background-color: #1e0d0d;
      color: #f0f0f0;
      font-family: 'Segoe UI', sans-serif;
    }
    .navbar {
      background-color: #1f1f2e;
    }
    .nav-link, .navbar-brand {
      color: #fdd835;
    }
    .nav-link:hover {
      color: #ffffff;
    }
    .section {
      padding: 60px 20px;
    }
    .bot-card {
      background-color: #1c1c2b;
      border-radius: 8px;
      padding: 20px;
      color: #fff;
      margin-bottom: 20px;
    }
    .btn-primary {
      background-color: #6a1b9a;
      border: none;
    }
    footer {
      background-color: #1f1f2e;
      color: #aaa;
      padding: 20px 0;
      text-align: center;
    }
    footer a {
      color: #fdd835;
      text-decoration: none;
    }
    #account-info {
      background: #2b2b3d;
      color: #fff;
      padding: 10px 20px;
      display: none;
      font-size: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.4);
    }
    #account-info button {
      float: right;
      background: #ff4c4c;
      border: none;
      color: white;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 13px;
    }
    #login-required {
      text-align: center;
      padding: 80px 20px;
      display: none;
    }
  </style>
</head>
<body>

<!-- üîê Account Info -->
<div id="account-info">
  <strong>üë§ Logged in as:</strong> <span id="account-id">---</span> |
  <strong>üí∞ Balance:</strong> <span id="account-balance">$0.00</span> |
  <strong>üìò Account Type:</strong> <span id="account-type">---</span>
  <button onclick="logoutDeriv()">Logout</button>
</div>

<!-- üîê Login Required -->
<div id="login-required">
  <h2 class="text-warning mb-4">üîê Login Required</h2>
  <p class="text-light mb-4">Please log in with your Deriv account to access the tools.</p>
  <a href="https://oauth.deriv.com/oauth2/authorize?app_id=YOUR_APP_ID&redirect_uri=https://profitshade.vercel.app" class="btn btn-lg btn-success px-4">
    üîê Login with Deriv
  </a>
</div>

<!-- üîß Tool Sections -->
<div id="tool-sections" style="display: none;">
  <!-- üîπ Navbar -->
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"><img src="/logo.png" alt="logo" width="30" /> PROFITSHADE_FX</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="#freebots">Free Bots</a></li>
          <li class="nav-item"><a class="nav-link" href="#botbuilder">Bot Builder</a></li>
          <li class="nav-item"><a class="nav-link" href="#strategy">Strategies</a></li>
          <li class="nav-item"><a class="nav-link" href="#risk">Risk Calc</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- üß† Free Bots -->
  <section class="section" id="freebots">
    <div class="container text-center">
      <h2 class="text-warning mb-4">üß† Select a Bot to Load</h2>
      <div class="row">
        <div class="col-md-4 mb-3"><button class="btn btn-outline-warning w-100" onclick="loadBot('bots/Killer-market-AI.xml')">Killer Market AI</button></div>
        <div class="col-md-4 mb-3"><button class="btn btn-outline-warning w-100" onclick="loadBot('bots/CMV-Pro.xml')">CMV Pro</button></div>
      </div>
    </div>
  </section>

  <!-- ü§ñ Bot Builder -->
  <section class="section" id="botbuilder">
    <div class="container text-center">
      <h4 class="text-warning mb-4">ü§ñ Bot Builder</h4>
      <iframe id="botBuilderIframe" src="https://app.deriv.com/bot" width="100%" height="600" style="border: 1px solid #444; border-radius: 10px;"></iframe>
    </div>
  </section>

  <!-- üìò Strategies -->
  <section class="section" id="strategy">
    <div class="container">
      <h4 class="text-warning">üìò Strategy Highlights</h4>
      <p><strong>Even/Odd:</strong> Look for 55% win rate and 3+ opposite digits before entry.</p>
      <p><strong>Over/Under:</strong> Choose under 8 or over 1 when low digits drop below 10%.</p>
      <p><strong>Differs:</strong> Entry when predicted digit hits, with under 9% prediction rate.</p>
    </div>
  </section>

  <!-- üßÆ Risk Calculator -->
  <section class="section" id="risk">
    <div class="container">
      <h4 class="text-warning mb-4">üßÆ Martingale Risk Calculator</h4>
      <form oninput="calcMartingale()">
        <input type="number" id="capital" class="form-control mb-2" placeholder="Total Capital">
        <input type="number" id="initial" class="form-control mb-2" placeholder="Initial Stake">
        <input type="number" id="levels" class="form-control mb-2" placeholder="Martingale Levels">
      </form>
      <div class="alert alert-dark mt-3">
        <strong>Stake Levels:</strong>
        <ul id="stakeList" class="mb-0"></ul>
        <hr>
        <strong>Total Risk:</strong> <span id="totalRisk">$0.00</span> |
        <strong>Remaining:</strong> <span id="remaining">$0.00</span>
      </div>
    </div>
  </section>
</div>

<!-- üîö Footer -->
<footer>
  <p>¬© 2025 ProfitShade FX ‚Ä¢ Designed by Agustine ‚Ä¢ <a href="https://deriv.com/signup?sidc=F29079D3-31B8-4321-8A5B-0B13DBD26761" target="_blank">Sign up on Deriv</a></p>
</footer>

<!-- ‚úÖ Scripts -->
<script>
  const urlParams = new URLSearchParams(window.location.search);
  const tokenFromUrl = urlParams.get("token");

  if (tokenFromUrl) {
    localStorage.setItem("deriv_token", tokenFromUrl);
    window.location.href = window.location.origin + window.location.pathname;
  }

  const savedToken = localStorage.getItem("deriv_token");

  if (savedToken) {
    document.getElementById("tool-sections").style.display = "block";
    document.getElementById("login-required").style.display = "none";
    document.getElementById("account-info").style.display = "block";

    fetch("https://api.deriv.com/api/v1/authorize", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ authorize: savedToken }),
    })
    .then(res => res.json())
    .then(data => {
      const account = data.authorize;
      document.getElementById("account-id").textContent = account.loginid;
      document.getElementById("account-balance").textContent = `$${account.balance.toFixed(2)}`;
      document.getElementById("account-type").textContent = account.account_type === "virtual" ? "Demo" : "Real";
    })
    .catch(() => {
      alert("Authorization failed. Please log in again.");
      logoutDeriv();
    });
  } else {
    document.getElementById("login-required").style.display = "block";
    document.getElementById("tool-sections").style.display = "none";
    document.getElementById("account-info").style.display = "none";
  }

  function logoutDeriv() {
    localStorage.removeItem("deriv_token");
    alert("You have been logged out.");
    location.reload();
  }

  function loadBot(botUrl) {
    const iframe = document.getElementById("botBuilderIframe");
    iframe.src = `https://app.deriv.com/bot?bot=${botUrl}`;
    document.getElementById('botbuilder').scrollIntoView({ behavior: 'smooth' });
  }

  function calcMartingale() {
    const capital = parseFloat(document.getElementById("capital").value) || 0;
    const initial = parseFloat(document.getElementById("initial").value) || 0;
    const levels = parseInt(document.getElementById("levels").value) || 0;
    const stakeList = document.getElementById("stakeList");
    stakeList.innerHTML = "";

    let totalRisk = 0;
    for (let i = 0; i < levels; i++) {
      const stake = initial * Math.pow(2, i);
      totalRisk += stake;
      const li = document.createElement("li");
      li.textContent = `Level ${i + 1}: $${stake.toFixed(2)}`;
      stakeList.appendChild(li);
    }

    const remaining = capital - totalRisk;
    document.getElementById("totalRisk").textContent = `$${totalRisk.toFixed(2)}`;
    document.getElementById("remaining").textContent = `$${remaining.toFixed(2)}`;
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script src="js/main.js"></script>

</body>
</html>
